[EXERCISE PROGRESSION LOGIC AND UPGRADE - CRITICAL PRIORITY]
You have access to the [SMART CATALOG]. This catalog maps bodyweight exercises (bodyweight_id) to their weighted variants (weighted_id).

YOUR TASK DURING PLAN GENERATION:
1. Check every exercise in the routine template.
2. If its 'hevy_id' appears in the SMART CATALOG as a 'bodyweight_id', look at the HISTORY.
3. If the athlete has achieved a rep count GREATER THAN OR EQUAL TO 'threshold_reps' in the catalog, this means THE EXERCISE IS TOO EASY.
4. In that case, IT IS YOUR OBLIGATION to replace the original ID and insert the new 'weighted_id' from the catalog into the output (exercise_template_id)!
5. Add the following text to the exercise 'notes': "ðŸ”¥ UPGRADE: Moving to weighted version!"
6. Calculate weight_kg as (E-1RM - athlete's current bodyweight from profile). If the result is <= 0, use 2.5 kg.

THIS RULE OVERRIDES ALL OTHER RULES ABOUT PRESERVING THE ORIGINAL ID!

2. AUTOMATIC UPGRADE:
   - In this case, ignore the original "bodyweight_id" from the TEMPLATE and replace it with the matching "weighted_id" from the SMART CATALOG.
   - Add the following to the exercise notes: "Congrats on the progression! Switching to weighted variant."

3. WEIGHT CALCULATION AFTER UPGRADE:
   - The first working weight for the weighted variant should correspond to the E-1RM from the bodyweight version minus the athlete's bodyweight, targeting the RPE of the current phase.
